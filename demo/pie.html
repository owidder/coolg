<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<style>

    .arc text {
        font: 10px sans-serif;
        text-anchor: middle;
    }

    .arc path {
        stroke: #fff;
    }

</style>
</head>
<body>
<script src="../bower_components/d3/d3.js"></script>
<script src="../bower_components/lodash/dist/lodash.js"></script>

<script>

    var width = 960,
        height = 500,
        radius = Math.min(width, height) / 2;

    var color = d3.scaleOrdinal(d3["schemeCategory20"]);

    var numberOfRings = 10;
    var numberOfSections = 20;
    var data = _.range(numberOfRings).map(function(index) {
        var inner = index * (radius / numberOfRings);
        var outer = (index+1) * (radius / numberOfRings);
        return {
            ringNo: index,
            arc: d3.arc().outerRadius(outer).innerRadius(inner),
            pie: d3.pie()(_.fill(_.range(numberOfSections), 1))
        }
    });

    var svg = d3.select("body").append("svg")
        .attr("width", width)
        .attr("height", height)
        .append("g")
        .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

    var gRingData = svg.selectAll("g.ring").data(data);
    var gRingEnter = gRingData.enter();

    var gRing = gRingEnter.append("g")
        .attr("class", "ring");

    var gArc = gRing.selectAll("g.arc")
        .data(function (d) {
            return d.pie;
        })
        .enter()
        .append("g")
        .attr("class", "arc");

    gArc.append("path")
        .attr("d", function (d) {
            var arc = this.parentNode.parentNode.__data__.arc;
            return arc(d);
        })
        .style("fill", function(d, i) {
            return color(i);
        })
        .style("opacity", function (d) {
            var ringNo = this.parentNode.parentNode.__data__.ringNo;
            var opacity = (1 / numberOfRings) * ringNo;
            return opacity;
        })

</script>
</body>
</html>