<!DOCTYPE html>
<html>
<head>
    <title>Dancing dots</title>
    <link rel="stylesheet" href="../../bower_components/Materialize/dist/css/materialize.min.css">
    <script src="../../bower_components/jquery/dist/jquery.min.js"></script>
    <script src="../../bower_components/js-url/url.min.js"></script>
    <script src="../../lib/d3.v4.min.js"></script>
    <script src="../../bower_components/Materialize/dist/js/materialize.min.js"></script>
    <script src="SimplePromise.js"></script>
    <script src="SimpleEvent.js"></script>
    <script src="buildGraph.js"></script>
    <script src="move.js"></script>
    <style>
        .link {
            stroke: #2E2E2E;
            stroke-width: 2px;
        }

        .node {
            stroke: #fff;
            stroke-width: 2px;
        }
        .textClass {
            stroke: #323232;
            font-family: "Lucida Grande", "Droid Sans", Arial, Helvetica, sans-serif;
            font-weight: normal;
            stroke-width: .5;
            font-size: 14px;
        }
    </style>
</head>
<body>

<div id="graph"></div>

<script>
    window.addEventListener("DOMContentLoaded", function() {
        var w = $(window).width();
        var h = $(window).height();

        var buildGraph = new BuildGraph(w, h, "svg", "graph", 10);

        function randomRunColor() {
            return Math.random() < 0.75 ? "green" : "red";
        }

        var i;
        var ids = [];
        var ctr = 0;
        var stopEvents = [];
        var MAX = 5;
        var r = Math.min(w, h) / 2 - 50;
        var ANGLE_STEP = 360 / MAX;

        function addRunsRecursively() {
            var id = "Node-" + ctr++;
            ids.push(id);
            buildGraph.addNewRun(id, randomRunColor());
            var waitTime = Math.random() * 2000;
            if(ctr < MAX) {
                setTimeout(addRunsRecursively, waitTime);
            }
            else {
                var step = Math.random() < 0.5 ? 1 : -1;
                for(i = 0; i < ids.length; i++) {
                    stopEvents.push(moveOnCircle(buildGraph.simulation, ids[i], w/2, h/2, r, 360 - i*ANGLE_STEP, step));
                }
            }
        }

        addRunsRecursively();
    }, false);
</script>

</body>
</html>